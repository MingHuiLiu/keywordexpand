select
                         distinct
                        fbiz_uin as bizuin,
                        fuser_uin as uin
                    from
                        cdg_weixin_secret::daily_raw_weixin_biz_user_relations
                    where
                        (fdate_cd = %s and  fdelete_flag <> 2)
						
						
    sql = " SELECT * FROM wxy_sourceid_partition where taskid = '%s' and tag = 1"%taskid_
    res = tdw.execute(sql)
    if res is not  None:
        idx =0
        sql = '''insert table wxy_daily_game_uinlist
               SELECT
                    '%s' as taskid,
                    uin_ as uin ,
                    '1' as tag ,
                    '1' as flag,
                     1 as score
                FROM cdg_weixin_tdbank::log_10377
                WHERE'''%(taskid_)
        for oneArticle in res:
            subList = oneArticle.split("\t")
            print subList
            articleis = subList[1].split("_")
            if len(articleis) < 3:
                print "<3"
                continue
            bizuin = articleis[0]
            msgid = articleis[1]
            itemidx = articleis[2]
            if bizuin == 'READ':
                continue
            if idx != 0:
                sql += " or "
            else:
                idx = idx + 1
            sql += "(bizuin_=%s and msgid_=%s and itemidx_=%s)"%(bizuin,msgid,itemidx)
        WriteLog("running=",sql)
        res = tdw.execute(sql)
        WriteLog("running=",sql)

    sql = " SELECT * FROM wxy_sourceid_partition where ds = '%s' and tag = 0"%taskid_
    res = tdw.execute(sql)
    if res is not  None:
        idx =0
        sql = '''insert table wxy_daily_game_uinlist
               SELECT
                    '%s' as taskid,
                    useruin_ as uin ,
                    '0' as tag ,
                    '1' as flag,
                    1 as score
                FROM cdg_weixin_tdbank::log_10296
                WHERE'''%(taskid_)
        for oneArticle in res:
            subList = oneArticle.split("\t")
            id = subList[0]
            if idx != 0:
                sql += " or "
            else:
                idx = idx + 1
            sql += "(bizuin_=%s )"%(id)
        WriteLog("running=",sql)
        res = tdw.execute(sql)
		
		
CREATE TABLE daily_raw_weixin_biz_user_relations(
    fdate_cd INT COMMENT '分区时间',
    fbiz_uin BIGINT COMMENT '公众账号',
    fuser_uin BIGINT COMMENT '收听者账号',
    fcreate_time BIGINT COMMENT '创建时间',
    fupdate_time BIGINT COMMENT '更新时间',
    ftype INT COMMENT '来源',
    ffunc_flag INT COMMENT '星标好友',
    fdelete_flag INT COMMENT '删除标记'